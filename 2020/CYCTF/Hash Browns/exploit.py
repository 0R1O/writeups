#!/usr/bin/python3

import csv
import hashlib
from typing import *
from threading import Thread

THREADS=4
MAXN=10**7

def crack(f: int, t: int, cities: List[str], target: str) -> None:
    print(f'[*] Cracking range [{f},{t}] ... ')
    for i in range(f, t):
        for c in cities:
            p = c + str(i)
            h = hashlib.sha512(p.encode()).hexdigest()
            if h.upper() == target.upper():
                print(f'\033[35m[+] Found the password ("{p}") ... \033[0m')
                return

def main():
    h = ''
    with open('./hash.txt', 'r') as f:
        h = f.read().strip()

    cities = []
    with open('./fr.csv', 'r') as f:
        reader = csv.reader(f, delimiter=',', quotechar='"')
        reader.__next__()
        for r in reader:
            cities.append(r[0].lower())
    
    step = MAXN//THREADS

    ts = []
    for i in range(THREADS-1):
        ts.append(Thread(target=crack, args=(i*step, (i+1)*step, cities, h)))
        ts[-1].start()
    ts.append(Thread(target=crack, args=((THREADS-1)*step, MAXN, cities, h)))
    ts[-1].start()

    try:
        for t in ts:
            t.join()
    except KeyboardInterrupt:
        print('[*] Interrupted ... Exiting ... ')

if __name__ == '__main__':
    main()
